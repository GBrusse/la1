; 'subj' is short for 'subject', 'srch' is short for 'search', and 'repl' is short for 'replacement'

(define (replace-random repl)
  (if (pair? repl)
      (cons (replace-random (car repl))
            (replace-random (cdr repl)))
      (if (eq? repl 'RANDOM)
          (random 100)
          repl)))

(define (tsar subj srch repl)
  (if (null? subj)
      '()
      (if (and (not (pair? subj)) (not (eq? subj srch)))
          subj
          (if (eq? subj srch)
              (replace-random repl)
              (cons (tsar (car subj) srch repl)
                    (tsar (cdr subj) srch repl))))))